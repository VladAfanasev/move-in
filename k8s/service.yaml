---
apiVersion: v1
kind: Service
metadata:
  name: move-in-service
  namespace: default
  labels:
    app: move-in
    component: service
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: http
    protocol: TCP
    name: http
  selector:
    app: move-in

---
# Optional: Ingress for external access
# Uncomment and configure based on your ingress controller
# apiVersion: networking.k8s.io/v1
# kind: Ingress
# metadata:
#   name: move-in-ingress
#   namespace: default
#   labels:
#     app: move-in
#   annotations:
#     # Configure based on your ingress controller
#     # nginx.ingress.kubernetes.io/rewrite-target: /
#     # cert-manager.io/cluster-issuer: "letsencrypt-prod"
# spec:
#   # Optional: TLS configuration
#   # tls:
#   # - hosts:
#   #   - move-in.yourdomain.com
#   #   secretName: move-in-tls
#   rules:
#   - host: move-in.yourdomain.com
#     http:
#       paths:
#       - path: /
#         pathType: Prefix
#         backend:
#           service:
#             name: move-in-service
#             port:
#               number: 80

---
# Optional: Horizontal Pod Autoscaler for automatic scaling
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: move-in-hpa
  namespace: default
  labels:
    app: move-in
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: move-in-app
  minReplicas: 2
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80